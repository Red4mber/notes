
use this command to list installed KB
`wmic qfe list brief`

## MS17-010 - EternalBlue 

Old as shit, probably not there if the target has been patched in the last century. 
It's an SMB Unauthenticated RCE, an exploit exists on MSF, just click and run, very much skiddie stuff  <br>
Can be used for privesc if smb port 445 is firewalled.


## CVE-2021-36934 HiveNightmare, aka SeriousSam 

Windows 10 vulnerability that results in every users having rights to read the SAM, SYSTEM and SECURITY hives and create copies of it.

Using icacls to detect it :
```
C:\temp> icacls c:\Windows\System32\config\SAM

C:\Windows\System32\config\SAM BUILTIN\Administrators:(I)(F)
                               NT AUTHORITY\SYSTEM:(I)(F)
                               BUILTIN\Users:(I)(RX)
                               APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES:(I)(RX)
                               APPLICATION PACKAGE AUTHORITY\ALL RESTRICTED APPLICATION PACKAGES:(I)(RX)

Successfully processed 1 files; Failed processing 0 files
```
Here, the system is vulnerable, you can see the line `BUILTIN\Users:(I)(RX)` meaning everyone can read SAM.
You can use [this PoC](https://github.com/GossiTheDog/HiveNightmare) to create copies of the hives and later dump the hashes they contain using secretsdump.py.

## CVE-2021-1675/CVE-2021-34527 PrintNightmare

A vulnerability in RpcAddPrinterDriver which allows any authenticated user to add a print driver, regardless of their privileges. This allows attackers to get full remote code execution as SYSTEM on any affected system.

[This POC](https://github.com/cube0x0/CVE-2021-1675) can be used to execute DLLs remotely or locally.
[This PowerShell script](https://github.com/calebstewart/CVE-2021-1675) can be used for quick privilege escalation.

You can check for this vulnerability by checking the presence of the print spooler  :
```
ls \\localhost\pipe\spoolss
```
If it's there, you got yourself an easy privesc :D <br>
To run the exploit, don't forget to set `Set-ExecutionPolicy Bypass -Scope CurrentUser` <br>
Then, you can Import-Module the ps1 and call Invoke-Nightmare.



## CVE-2020-0668
oh la flemme
euh ca existe, demerde toi, y'a plein de PoC sur le net